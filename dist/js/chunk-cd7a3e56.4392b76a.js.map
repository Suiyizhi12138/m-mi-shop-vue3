{"version":3,"sources":["webpack:///./src/views/user/UserLogin.vue?46ed","webpack:///./src/views/user/UserLogin.vue","webpack:///./src/views/user/UserLogin.vue?f246"],"names":["class","src","alt","href","for","to","type","name","id","validateOptions","emailMessage","placeholder","email","checkEmail","passwordMessage","password","checkPassword","checked","loginStatus","value","onLogin","components","UserHeader","setup","state","isEmailValidated","isPasswordValidated","store","regexpEmail","trim","test","regexpPassword","Promise","resolve","then","login","fail","loading","data","postLogin","res","localStorage","setItem","access_token","dispatch","a","defaults","headers","common","getItem","clear","window","location","DOMAIN","catch","e","console","log","__exports__","render"],"mappings":"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","file":"js/chunk-cd7a3e56.4392b76a.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./UserLogin.vue?vue&type=style&index=0&id=ddea7de4&lang=scss&scoped=true\"","<template>\r\n  <!-- 用户登录页 -->\r\n  <div class=\"user-login-page\">\r\n    <user-header></user-header>\r\n    <div class=\"logo-content\">\r\n      <router-link to=\"/home\">\r\n      <img src=\"@/assets/images/login/logo-mi2.png\" alt />\r\n      </router-link>\r\n      <p>让每个人都能享受科技带来的乐趣</p>\r\n    </div>\r\n    <div class=\"form-content\">\r\n      <h3 class=\"form-title\">小米账号登录</h3>\r\n      <form class=\"form-login\">\r\n        <input\r\n          type=\"text\"\r\n          name=\"email\"\r\n          id=\"email\"\r\n          class=\"input-item input-phone\"\r\n          placeholder=\"请输入Email账号\"\r\n          :class=\"{'input-fail':validateOptions.emailMessage}\"\r\n          v-model=\"email\"\r\n          @input=\"checkEmail\"\r\n        />\r\n        <label for=\"email\" v-show=\"validateOptions.emailMessage\">{{validateOptions.emailMessage}}</label>\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          id=\"password\"\r\n          class=\"input-item input-password\"\r\n          placeholder=\"请输入密码\"\r\n          :class=\"{'input-fail':validateOptions.passwordMessage}\"\r\n          v-model=\"password\"\r\n          @input=\"checkPassword\"\r\n        />\r\n        <label for v-show=\"validateOptions.passwordMessage\">{{validateOptions.passwordMessage}}</label>\r\n        <div class=\"verify-content\" v-if=\"false\">\r\n          <input type=\"text\" name=\"verify_code\" class=\"input-item\" />\r\n          <img src alt class />\r\n        </div>\r\n        <div class=\"input-allow\">\r\n          <input type=\"checkbox\" name=\"check_rule\" id=\"rule\" v-model=\"checked\" />\r\n          <p>\r\n            已阅读并同意小米账号\r\n            <a href=\"javascript:\">用户协议</a>和\r\n            <a href=\"javascript:\">隐私政策</a>\r\n          </p>\r\n        </div>\r\n        <input\r\n          type=\"button\"\r\n          class=\"input-item input-button\"\r\n          value=\"登录\"\r\n          @click=\"onLogin\"\r\n          :class=\"{'btn-disabled':loginStatus==1}\"\r\n        />\r\n        <label for class=\"label-forget\">\r\n          没有账号?\r\n          <router-link to=\"/user/register\">注册</router-link>\r\n        </label>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UserHeader from \"./components/UserHeader\";\r\nimport { reactive, toRefs } from \"vue\";\r\nimport FetchAPI from \"@/utils/fetchApi\";\r\nimport { Toast } from \"vant\";\r\nimport { useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport axios from 'axios'\r\nimport Config from '@/config/index'\r\nexport default {\r\n  components: {\r\n    UserHeader\r\n  },\r\n  setup() {\r\n    const router = useRouter()\r\n    const state = reactive({\r\n      email: \"\",\r\n      password: \"\",\r\n      checked: false,\r\n      validateOptions: {\r\n        emailMessage: \"\",\r\n        passwordMessage: \"\",\r\n        isEmailValidated: false,\r\n        isPasswordValidated: false\r\n      },\r\n      loginStatus: 0 //0未登录 1-loginig 2-logined 3-failed\r\n    });\r\n    const store = useStore()\r\n    const checkEmail = () => {\r\n      state.validateOptions.isEmailValidated = true;\r\n      const regexpEmail = /^([a-zA-Z]|[0-9])(\\w)+@[a-zA-Z0-9]+\\.([a-zA-Z]{2,4})$/;\r\n      if (state.email.trim() === \"\") {\r\n        state.validateOptions.emailMessage = \"请输入邮箱\";\r\n        return;\r\n      }\r\n      if (regexpEmail.test(state.email)) {\r\n        state.validateOptions.emailMessage = \"\";\r\n      } else {\r\n        state.validateOptions.emailMessage = \"输入邮箱格式不正确\";\r\n      }\r\n    };\r\n    const checkPassword = () => {\r\n      state.validateOptions.isPasswordValidated = true;\r\n      const regexpPassword = /^(\\w){6,20}$/;\r\n      if (state.password.trim() === \"\") {\r\n        state.validateOptions.passwordMessage = \"请输入密码\";\r\n        return;\r\n      } else {\r\n        if (regexpPassword.test(state.password)) {\r\n          state.validateOptions.passwordMessage = \"\";\r\n        } else {\r\n          state.validateOptions.passwordMessage =\r\n            \"密码长度为6-20为 且只能包含字母数字和下划线\";\r\n        }\r\n      }\r\n    };\r\n    const onLogin = () => {\r\n      checkEmail();\r\n      checkPassword();\r\n      Promise.resolve().then(() => {\r\n        if (!state.validateOptions.isEmailValidated) {\r\n          Toast.fail(\"请确认是否输入邮箱\");\r\n          return;\r\n        }\r\n        if (!state.validateOptions.isPasswordValidated) {\r\n          Toast.fail(\"请确认是否输入密码\");\r\n          return;\r\n        }\r\n        if (!state.checked) {\r\n          Toast.fail(\"请确认勾选用户协议和隐私政策\");\r\n          return;\r\n        }\r\n        login();\r\n      });\r\n    };\r\n    const login = () => {\r\n      state.loginStatus = 1;\r\n      Toast.loading('登录中')\r\n      const data = {\r\n        email: state.email,\r\n        password: state.password\r\n      };\r\n      FetchAPI.postLogin(data)\r\n        .then(res => {\r\n          state.loginStatus = 2;\r\n          localStorage.setItem('_user_token',res.data.access_token);\r\n          store.dispatch('checkUserLoginStatus')\r\n          axios.defaults.headers.common['Authorization'] = 'Bearer ' + localStorage.getItem('_user_token');\r\n          Toast.clear()\r\n          window.location.href = Config.DOMAIN+'/#/user'\r\n        })\r\n        .catch((e) => {\r\n          state.loginStatus = 3;\r\n          console.log(e);\r\n          Toast.fail('登录失败')\r\n        });\r\n    };\r\n    return {\r\n      ...toRefs(state),\r\n      checkEmail,\r\n      checkPassword,\r\n      onLogin\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.user-login-page {\r\n  @media screen and(min-height: 667px) {\r\n    div.form-content {\r\n      margin-top: 30px;\r\n    }\r\n    div.logo-content {\r\n      margin-top: 60px;\r\n    }\r\n  }\r\n  @media screen and(min-height: 812px) {\r\n    div.form-content {\r\n      margin-top: 60px;\r\n    }\r\n    div.logo-content {\r\n      margin-top: 120px;\r\n    }\r\n  }\r\n  @media screen and(min-height: 900px) {\r\n    div.form-content {\r\n      margin-top: 80px;\r\n    }\r\n    div.logo-content {\r\n      margin-top: 160px;\r\n    }\r\n  }\r\n  .logo-content {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    img {\r\n      width: 50px;\r\n      height: 50px;\r\n    }\r\n    p {\r\n      margin-top: 20px;\r\n      font-size: 14px;\r\n      color: #999;\r\n    }\r\n  }\r\n  .form-content {\r\n    padding: 0 16px;\r\n  }\r\n  text-align: left;\r\n  .form-title {\r\n    font-size: 18px;\r\n    font-weight: 700;\r\n    text-align: left;\r\n    padding: 20px 0;\r\n  }\r\n  .form-login {\r\n    display: flex;\r\n    justify-content: center;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    .input-item {\r\n      display: block;\r\n      height: 50px;\r\n      width: 320px;\r\n      border: 2px solid #f5f5f5;\r\n      background-color: #f5f5f5;\r\n      border-radius: 25px;\r\n      font-size: 16px;\r\n      box-sizing: border-box;\r\n      padding-left: 20px;\r\n      margin-bottom: 12px;\r\n      transition: all 0.3s linear;\r\n      &:focus {\r\n        border: 2px solid blue;\r\n      }\r\n    }\r\n    input.input-fail {\r\n      border-color: #ff2300;\r\n    }\r\n    label {\r\n      padding-left: 16px;\r\n      margin-top: -10px;\r\n      margin-bottom: 12px;\r\n      color: #ff6700;\r\n      display: block;\r\n      align-self: start;\r\n    }\r\n    .input-allow {\r\n      display: flex;\r\n      align-items: center;\r\n      p {\r\n        padding-left: 8px;\r\n        font-size: 14px;\r\n        a {\r\n          color: #0f86ff;\r\n        }\r\n      }\r\n    }\r\n    .input-button {\r\n      margin-top: 12px;\r\n      background-color: #ff6700;\r\n      color: #fff;\r\n      &:focus {\r\n        border: none;\r\n      }\r\n    }\r\n    input.btn-disabled{\r\n      background-color: #666;\r\n    }\r\n    label.label-forget {\r\n      color: #0f86ff;\r\n      margin-top: 40px;\r\n      a {\r\n        color: #ff6700;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import { render } from \"./UserLogin.vue?vue&type=template&id=ddea7de4&scoped=true\"\nimport script from \"./UserLogin.vue?vue&type=script&lang=js\"\nexport * from \"./UserLogin.vue?vue&type=script&lang=js\"\n\nimport \"./UserLogin.vue?vue&type=style&index=0&id=ddea7de4&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\Doc\\\\web\\\\Vue\\\\App\\\\m-mi-shop\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ddea7de4\"]])\n\nexport default __exports__"],"sourceRoot":""}